import("Music.msg");

const int PersonaStartID = 579;
const int PersonaEndID = 585;
const int SMTStartID = 586;
const int SMTEndID = 587;
const int SpinStartID = 588;
const int SpinEndID = 592;

void BGMorder_for_huka() {
	// Mask some	Random stuff out
	int mask = 0;
	if (FUNCTION_018B(6, 339) == 0) {
		mask = 1;
	}
	SET_MASK(mask);
	
	// bind exit correctly
	SEL_CHK_PAD(6, 3);
	SEL_CHK_PAD(9, 4);
	int selection = SEL(BGMHUKA_OREDER_SEL);
	switch (selection) {
		case 0: // escape menu
			MSG(HUKA_ORDER_ESCAPE);
			SEL_CHK_PAD(6, 1);

			if (FUNCTION_01E9()) {
				selection = SEL(FES_ESCAPE_SEL);
			} else {
				selection = SEL(ESCAPE_SEL);
			}

			if (selection == 0) {
				MSG(HUKA_ORDER_ESCAPE_GO);
				CLOSE_MSG_WIN();
				FUNCTION_00B7(0);
				BIT_ON((((0 + 0x0400) + 0x0800) + 121));
				return_to_entrance();
				return;
			}

			MSG(HUKA_ORDER_RESTART);
			BGMorder_for_huka();
			return;
		case 1: // music menu, the rest of the code focuses on this
			BGMorder_to_change_bgm();
			return;
		case 2: // go back to tartarus music
			// Checks if answer
			if (FUNCTION_01E9()) {

				if ((GET_FLOOR_ID() >= 2) && (GET_FLOOR_ID() <= 20)) {
				playBGM(94);
				} else if ((GET_FLOOR_ID() >= 21) && (GET_FLOOR_ID() <= 40)) {
				playBGM(95);
				} else if ((GET_FLOOR_ID() >= 41) && (GET_FLOOR_ID() <= 70)) {
				playBGM(96);
				} else if ((GET_FLOOR_ID() >= 71) && (GET_FLOOR_ID() <= 100)) {
				playBGM(97);
				} else if ((GET_FLOOR_ID() >= 101) && (GET_FLOOR_ID() <= 130)) {
				playBGM(98);
				} else if ((GET_FLOOR_ID() >= 131) && (GET_FLOOR_ID() <= 160)) {
				playBGM(99);
				} else if ((GET_FLOOR_ID() >= 160) && (GET_FLOOR_ID() <= 190)) {
				playBGM(100);
				}
			} else if ((GET_FLOOR_ID() >= 2) && (GET_FLOOR_ID() <= 0x10) ||
								 ((GET_FLOOR_ID() >= 290) && (GET_FLOOR_ID() <= 299))) {
			playBGM(1);
			} else if ((GET_FLOOR_ID() >= 17) && (GET_FLOOR_ID() <= 0x40)) {
			playBGM(70);
			} else if ((GET_FLOOR_ID() >= 65) && (GET_FLOOR_ID() <= 114)) {
			playBGM(81);
			} else if ((GET_FLOOR_ID() >= 115) && (GET_FLOOR_ID() <= 164)) {
			playBGM(72);
			} else if ((GET_FLOOR_ID() >= 164) && (GET_FLOOR_ID() <= 214)) {
			playBGM(73);
			} else if ((GET_FLOOR_ID() >= 215) && (GET_FLOOR_ID() <= 254)) {
			playBGM(74);
			} else if (((GET_FLOOR_ID() >= 255) && (GET_FLOOR_ID() <= 263))) {
			playBGM(75);
			}
			MSG(HUKA_ORDER_BGM_CHANGE_RE);
			break;
		case 3:
			break;
		case 4:
			UnlockAll();
			break;
		default:
			break;
	}

	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
}

void ShowFuukaTutorial()
{
	MSG_HELP( Fuuka_Tutorial );
	BIT_ON( 9998 );
	return;
}

void ShowUnlockTutorial()
{
	MSG_HELP( Unlock_Tutorial );
	BIT_ON( 9996 );
	return;
}

void UnlockAll()
{
	MSG(UnlockAll);
	int YesOrNo = SEL(YesNo);
	switch (YesOrNo) {
		case 0:
			AnswerMusic();
			return;
		case 1:
			return;
	}
	return;
}

void BGMorder_to_change_bgm() {
	if (AnySongs() != true)
	{
		OPEN_MSG_WIN();
		MSG(No_Music);
		CLOSE_MSG_WIN();
		FUNCTION_00B7(0);
		if ( BIT_CHK( 9996 ) == 0 )
		{
			ShowUnlockTutorial();
		}
		return;
	}
	if ( BIT_CHK( 9998 ) == 0 )
	{
		CLOSE_MSG_WIN();
		FUNCTION_00B7(0);
		ShowFuukaTutorial();
	}
	FUNCTION_00B7(0);
	int stayOpen = 1;
	while (stayOpen) {
		OPEN_MSG_WIN();
		MSG(BGMHUKA_ORDER_BGM_CHANGE);
		SEL_CHK_PAD(6, 99); // Exit menu, circle
		SEL_CHK_PAD(8, 81);	// shuffle current menu, select
		FUNCTION_011C(19, Fuukas);
		int selection = SEL(BGMBGM_SEL);
		switch (selection) {
			case 0:
				if (PersonaSongs() != true)
				{
					OPEN_MSG_WIN();
					MSG(No_PersonaMusic);
					CLOSE_MSG_WIN();
					FUNCTION_00B7(0);
					stayOpen = 0;
					return;
				}
				else {
					FUNCTION_0005();
					FUNCTION_00B7(0);
					stayOpen = P_Music();
				}
				break;
			case 1:
				if (SMTSongs() != true)
				{
					OPEN_MSG_WIN();
					MSG(No_SMTMusic);
					CLOSE_MSG_WIN();
					FUNCTION_00B7(0);
					stayOpen = 0;
					return;
				}
				else {
					FUNCTION_0005();
					FUNCTION_00B7(0);
					stayOpen = SMT_Music();
				}
				break;
			case 2:
				if (SpinSongs() != true)
				{
					OPEN_MSG_WIN();
					MSG(No_SpinMusic);
					CLOSE_MSG_WIN();
					FUNCTION_00B7(0);
					stayOpen = 0;
					return;
				}
				else {
					FUNCTION_0005();
					FUNCTION_00B7(0);
					stayOpen = SpinSMT_Music();
				}
				break;
			case 3: //Skip to case 81
			case 81:
				SET_CNT(9998, 1);
				Random();
				MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
				stayOpen = 0;
				break;
			default:
				stayOpen = 0;
				break;
		}
	}
	FUNCTION_0005();
	FUNCTION_00B7(0);
	CLOSE_MSG_WIN();
}

int P_Music()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 1;
			case 0:
				selecting = false;
				break;
			case 1:
				page = P_Music1();
				break;
			case 4:
				goto case 1;
			 default:
				break;
		}
	}
	return 0;
}

int P_Music1() {
	MSG(HUKA_ORDER_BGM_CHANGE2);
	FUNCTION_011C(19, PersonaSeries);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(P_Music);
	FUNCTION_0005();
	switch (selection) {
		case 0:
			if (!BIT_CHK(579)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return P1();
			}
		case 1:
			if (!BIT_CHK(580)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return IS();
			}
		case 2:
			if (!BIT_CHK(581)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return EP();
			}
		case 3:
			if (!BIT_CHK(582)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return P3();
			}
		case 4:
			if (!BIT_CHK(583)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return P4();
			}
		case 5:
			if (!BIT_CHK(584)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return PQ();
			}
		case 6:
			if (!BIT_CHK(585)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return P5();
			}
		case 7:
			SET_CNT(9998, 2);
			RandomPersona();
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 8:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 2);
			RandomPersona();
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO); 
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int P1()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = P1_1();
				break;
			 default:
				break;
		}
	}
	return 0;
}

int P1_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, Persona1);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(P1);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
		case 5:
			playBGM(p1_start + selection);
			break;
		case 6:
			SET_CNT(9998, 3);
			RandomGame(p1_len, p1_start, ShuffleP1, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 7:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(p1_len, p1_start, ShuffleP1, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int IS()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = IS_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int IS_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, PersonaIS);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(IS);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
		case 5:
		case 6:
		case 7:
		case 8:
		case 9:
			playBGM(is_start + selection);
			break;
		case 10:
			SET_CNT(9998, 3);
			RandomGame(is_len, is_start, ShuffleIS, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 11:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(is_len, is_start, ShuffleIS, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}

	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int EP()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = EP_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int EP_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, PersonaEP);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(EP);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
		case 5:
		case 6:
		case 7:
		case 8:
			playBGM(ep_start + selection);
			break;
		case 9:
			SET_CNT(9998, 3);
			RandomGame(ep_len, ep_start, ShuffleEP, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 10:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(ep_len, ep_start, ShuffleEP, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int P3()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = P3_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int P3_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, Persona3);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(P3);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
		case 3:
			playBGM(p3_start + selection);
			break;
		case 4:
			SET_CNT(9998, 3);
			RandomGame(p3_len, p3_start, ShuffleP3, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 5:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(p3_len, p3_start, ShuffleP3, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int P4()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = P4_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int P4_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, Persona4);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(P4);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:	
		case 3:
			playBGM(p4_start + selection);
			break;
		case 4:
			SET_CNT(9998, 3);
			RandomGame(p4_len, p4_start, ShuffleP4, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
		case 5:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(p4_len, p4_start, ShuffleP4, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int PQ()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = PQ_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int PQ_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, PersonaQ);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(PQ);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
			playBGM(pq_start + selection);
			break;
		case 3:
			SET_CNT(9998, 3);
			RandomGame(pq_len, pq_start, ShufflePQ, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 4:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(pq_len, pq_start, ShufflePQ, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int P5()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = P5_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int P5_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, Persona5);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(P5);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:	
		case 3:
			playBGM(p5_start + selection);
			break;
		case 4:
			SET_CNT(9998, 3);
			RandomGame(p5_len, p5_start, ShuffleP5, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 5:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(p5_len, p5_start, ShuffleP5, ShufflePersona);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int SMT_Music()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 1;
			case 0:
				selecting = false;
				break;
			case 1:
				page = SMT_Music1();
				break;
			case 2:
			case 3:
			case 4:
				goto case 1;
			 default:
				break;
		}
	}
	return 0;
}

int SMT_Music1() {
	MSG(HUKA_ORDER_BGM_CHANGE2);
	FUNCTION_011C(19, SMTSeries);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(SMT_Music);
	FUNCTION_0005();
	switch (selection) {
		case 0:
			if (!BIT_CHK(586)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return SMT1();
			}
		case 1:
			if (!BIT_CHK(587)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return SMT3();
			}
		case 2:
			SET_CNT(9998, 2);
			RandomSMT();
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break; 
		case 3:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 2);
			RandomSMT();
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		//case 4:
		//case 5:	
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int SMT1()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = SMT1_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int SMT1_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, Shin1);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(SMT1);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
		case 3:
			playBGM(smt1_start + selection);
			break;
		case 4:
			SET_CNT(9998, 3);
			RandomGame(smt1_len, smt1_start, ShuffleSMT1, ShuffleSMT);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 5:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(smt1_len, smt1_start, ShuffleSMT1, ShuffleSMT);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int SMT3()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = SMT3_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int SMT3_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, Shin3);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(SMT3);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
		case 3:
			playBGM(smt3_start + selection);
			break;
		case 4:
			SET_CNT(9998, 3);
			RandomGame(smt3_len, smt3_start, ShuffleSMT3, ShuffleSMT);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 5:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(smt3_len, smt3_start, ShuffleSMT3, ShuffleSMT);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int SpinSMT_Music()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 1;
			case 0:
				selecting = false;
				break;
			case 1:
				page = SpinSMT_Music_1();
				break;
			case 4:
				goto case 1;
			default:
				break;
		}
	}
	return 0;
}

int SpinSMT_Music_1() {
	MSG(HUKA_ORDER_BGM_CHANGE2);
	FUNCTION_011C(19, SpinSeries);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(SpinSMT_Music);
	FUNCTION_0005();
	switch (selection) {
		case 0:
			if (!BIT_CHK(588)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return MJ();
			}
		case 1:
			if (!BIT_CHK(589)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return MJ2();
			}
		case 2:
			if (!BIT_CHK(590)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return DDS();
			}
		case 3:
			if (!BIT_CHK(591)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return Raidou();
			}
		case 4:
			if (!BIT_CHK(592)) {
				OPEN_MSG_WIN();
				MSG(No_Album);
				return 4;
			}
			else {
				return Other();
			}
		case 5:
			SET_CNT(9998, 2);
			RandomSpin();
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 6:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 2);
			RandomSpin();
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int MJ()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = MJ_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int MJ_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, SpinMJ);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(MJ);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
			playBGM(mj_start + selection);
			break;
		case 3:
			SET_CNT(9998, 3);
			RandomGame(mj_len, mj_start, ShuffleMJ, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 4:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(mj_len, mj_start, ShuffleMJ, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break; 
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int MJ2()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = MJ2_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int MJ2_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, SpinMJ2);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(MJ2);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
			playBGM(mj2_start + selection);
			break;
		case 5:
			SET_CNT(9998, 3);
			RandomGame(mj2_len, mj2_start, ShuffleMJ2, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 6:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(mj2_len, mj2_start, ShuffleMJ2, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int DDS()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = DDS_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int DDS_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, SpinDDS);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(DDS);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
		case 3:
			playBGM(dds_start + selection);
			break;
		case 4:
			SET_CNT(9998, 3);
			RandomGame(dds_len, dds_start, ShuffleDDS, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 5:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(dds_len, dds_start, ShuffleDDS, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int Raidou()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = Raidou_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int Raidou_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, SpinRaidou);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(Raidou);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
		case 3:
			playBGM(rai_start + selection);
			break;
		case 4:
			SET_CNT(9998, 3);
			RandomGame(rai_len, rai_start, ShuffleRaidou, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 5:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(rai_len, rai_start, ShuffleRaidou, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

int Other()
{
	bool selecting = true;
	int page = 1;
	while(selecting)
	{
		switch(page)
		{	
			case -1:
				return 4;
			case 0:
				selecting = false;
				break;
			case 1:
				page = Other_1();
				break;
			default:
				break;
		}
	}
	return 0;
}

int Other_1() {
	MSG(HUKA_ORDER_BGM_CHANGE3);
	FUNCTION_011C(19, SpinSeries);
	SEL_CHK_PAD(6, 99); // Exit menu, circle
	SEL_CHK_PAD(13, 4); // next page, d-pad right
	SEL_CHK_PAD(15, 5); // prev page, d-pad left
	SEL_CHK_PAD(11, 80); // up 1 page, start
	SEL_CHK_PAD(8, 81);	// shuffle current menu, select

	int selection = SEL(Other);
	FUNCTION_0005();
	switch (selection) {
		case 0:
		case 1:
		case 2:
			playBGM(misc_start + selection);
			break;
		case 3:
			SET_CNT(9998, 3);
			RandomGame(misc_len, misc_start, ShuffleOther, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		case 4:
			return -1;
		case 80:
			return -1;
		case 81:
			SET_CNT(9998, 3);
			RandomGame(misc_len, misc_start, ShuffleOther, ShuffleSpin);
			MSG(BASE_HUKA_ORDER_BGM_CHANGE_DO);
			break;
		default:
			break;
	}
	CLOSE_MSG_WIN();
	FUNCTION_00B7(0);
	return 0;
}

bool AnySongs() {
	for (int i = PersonaStartID; i <= SpinEndID; i++) {
		if (BIT_CHK(i)) {
			return true;
		}
	}
	return false;
}

bool PersonaSongs() {
	for (int i = PersonaStartID; i <= PersonaEndID; i++) {
		if (BIT_CHK(i)) {
			return true;
		}
	}
	return false;
}

bool SMTSongs() {
	for (int i = SMTStartID; i <= SMTEndID; i++) {
		if (BIT_CHK(i)) {
			return true;
		}
	}
	return false;
}

bool SpinSongs() {
	for (int i = SpinStartID; i <= SpinEndID; i++) {
		if (BIT_CHK(i)) {
			return true;
		}
	}
	return false;
}


void AnswerMusic() {
	if (!BIT_CHK(579)) {
		for (int i = 579; i <= 592; i++) {
			if (!BIT_CHK(i)) {
				BIT_ON(i);
			 }
		}
	}
}